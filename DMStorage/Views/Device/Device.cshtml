@model DMStorage.Core.ViewModels.DevicesViewModel

@{
    ViewData["Title"] = "Devices";
}
@* <form class="form-inline justify-content-end" onsubmit="searchText(event)">
    <input class="form-control mt-2 mr-sm-2 bg-dark text-lightr" style="height:30px" type="search" id="searchInput" placeholder="Search" aria-label="Search">
    <button class="btn btn-sm btn-outline-success mt-2" type="submit">Search</button>
</form> *@
    <div class="mt-0">
        <form class="my-border mb-1" id="filterDeviceForm">
            <h3 class="m-3 text-info text-center ">Prehled zarizeni</h3>
            <div class="row ml-3">
                <div class="form-group">
                    @Html.LabelFor(x => x.TypeDevices, new { @class ="text-muted" })
                    @Html.DropDownListFor(x => x.TypeDevice.Id,
                             new SelectList(Model.TypeDevices, "Id", "Name"),
                             "--zvolte typ zarizeni--", new { @class = "form-control bg-dark text-light" })
                </div>
@*                 <div class="form-group ml-3">
                    @Html.LabelFor(x => x.TypeDevices, new { @class ="text-muted" })
                    @Html.DropDownListFor(x => x.TypeDevice.Id,
                             new SelectList(Model.TypeDevices, "Id", "Name"),
                             "--zvolte zarizeni--", new { @class = "form-control bg-dark text-light" })
                </div> *@
@*                 <div class="col-auto d-flex-inline mt-4" style="padding: 8px">
                    <button type="submit" class="btn btn-primary">Zobrazit</button>
                </div> *@
            </div>
        </form>
    </div>
    <div class=" my-border">
        @await Html.PartialAsync("_DeviceDataTablePartial.cshtml", Model)
    </div>


@* <script src="~/lib/jquery/dist/jquery.min.js"></script>
<link href="~/lib/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" /> *@

<script type="text/javascript">
            $(document).ready(function () {
                
            $('#TypeDevice_Id').change(function () {
            $('#filterDeviceForm').submit();
            });

            $('#filterDeviceForm').submit(function () {

                $.ajax({
                    type: "POST",
                    url: "@Url.Action("Devices", "Device")",
                    data: $(this).serialize(),
                    success: function (data) {
                        $('#deviceTable').html(data);
                    },
                    error: function (data) {
                        alert(data.message)
                    },
                    dataType: "html"
                });

                return false;
            });

        });

       function deleteDevice(id, btn) {
       if (!confirm("Opravdu chcete odstranit polozku?"))
           return;
       $.ajax({
           type: "POST",
           url: "@Url.Action("Delete", "Device")",
           data: {
               id: id
           },
           success: function (data) {
               if (data.success) {
                   var row = btn.parentNode.parentNode;
                   row.parentNode.removeChild(row);
               } else {
                   alert(data.message);
               }
           },
           error: function (data) {
               alert(data.message)
           },
           dataType: "json"
       });
      }

      $(function () {
  $('[data-toggle="tooltip"]').tooltip()
})
</Script>